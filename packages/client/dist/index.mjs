function p(e,n){return async c=>{let t=new URL(e.url);t.pathname=t.pathname+e.execPath,e.execArgs.push(c);let s=new e.impl.Request(t,{...e.options,body:JSON.stringify({args:e.execArgs})}),o=await fetch(s);return n(o)}}var a={get(e,n,c){let t=n;switch(e.execPath=e.execPath?e.execPath+"/"+t:t,n){case"call":return p(e,s=>s.json());case"stream":return p(e,s=>s.json());case"instance":return async s=>(e.execArgs.push(s),new Proxy(e,a));default:return new Proxy(e,a)}}};function R(e,n,c){let t=c||{fetch:global.fetch,Request:global.Request,Response:global.Response},s={method:"POST"},o={"content-type":"application/json"},h=n||{},u=n!=null&&n.headers?n.headers:{},l=new URL(e);return{e:r=>{r=r||{};let x=r!=null&&r.headers?r.headers:{},y={...u,...x,...o},i={...h,...r,...s,headers:y},T={url:l,options:i,impl:t,execArgs:[]};return new Proxy(T,a)}}}export{R as createClient};
